<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <title>ブログ | トップ</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-50">


	<div th:replace="user/layout/header :: siteHeader"></div>


<main class="max-w-7xl mx-auto px-6 py-10 grid grid-cols-1 md:grid-cols-3 gap-10">

    <!-- 記事一覧（メイン） -->
    <section class="md:col-span-2">
		<!-- ▼ 検索フォーム ▼ -->
		<form method="get" action="/blog" class="mb-6 flex gap-3">

		    <select name="category"
		            class="border rounded px-3 py-2">
		        <option value="">全カテゴリ</option>

		        <option th:each="cat : ${categories}"
		                th:value="${cat.id}"
		                th:selected="${cat.id == categoryId}"
		                th:text="${cat.name}">
		        </option>
		    </select>

		    <input type="text"
		           name="keyword"
		           placeholder="記事タイトルで検索"
		           th:value="${keyword}"
		           class="border rounded px-3 py-2 w-60"/>

		    <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
		        検索
		    </button>
		</form>


        <h2 class="text-xl font-semibold mb-6">
            <span th:if="${categoryId != null}">カテゴリ絞り込み</span>
            全ての記事
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

            <!-- 記事カード -->
            <a th:each="post : ${posts}" 
               th:href="@{'/blog/post/' + ${post.id}}"
               class="bg-white rounded-xl shadow hover:shadow-md transition overflow-hidden">

                <!-- サムネイル -->
                <img th:src="${post.imagePath}"
                     class="w-full h-48 object-cover bg-gray-200" alt="thumbnail"/>

                <div class="p-5">
                    <p class="text-xs text-blue-600 mb-2" 
                       th:text="${post.categoryName}">カテゴリー</p>

                    <h3 class="font-bold text-lg text-gray-800 mb-2"
                        th:text="${post.title}">タイトル</h3>

                    <p class="text-sm text-gray-500 mb-2"
                       th:text="${#temporals.format(post.createdAt, 'yyyy/MM/dd HH:mm')}">
                    </p>

                    <p class="text-sm text-gray-600 line-clamp-3"
                       th:text="${post.summary}">
                    </p>
                </div>
            </a>

        </div>

    </section>

    <!-- サイドバー -->
    <aside class="space-y-10">

        <!-- カテゴリ一覧 -->
        <div class="bg-white p-6 rounded-xl shadow">
            <h3 class="font-bold text-lg mb-4">カテゴリー</h3>

            <ul class="space-y-2">
                <li>
                    <a href="/blog"
                       class="text-gray-700 hover:text-blue-600">すべて</a>
                </li>
                <li th:each="cat : ${categories}">
                    <a th:href="@{/blog(category=${cat.id})}"
                       class="text-gray-700 hover:text-blue-600"
                       th:text="${cat.name}">
                    </a>
                </li>
            </ul>
        </div>

        <!-- 最近の投稿 -->
        <div class="bg-white p-6 rounded-xl shadow">
            <h3 class="font-bold text-lg mb-4">最近の投稿</h3>

            <div th:each="rp : ${recentPosts}" class="mb-4 border-b pb-2">
                <a th:href="@{'/blog/post/' + ${rp.id}}"
                   class="font-semibold text-gray-800 hover:text-blue-600"
                   th:text="${rp.title}"></a>
                <p class="text-xs text-gray-500"
                   th:text="${#temporals.format(rp.createdAt, 'yyyy/MM/dd')}"></p>
            </div>
        </div>

    </aside>

</main>

</body>
</html>
